import{a as M,s as E}from"./index.1665582543570.js";import{L as y}from"./leaflet-src.1665582543570.js";import{l as b,a as w,o as S}from"./vue.1665582543570.js";/*!
	Copyright (c) 2011-2015, Pavel Shramov, Bruno Bergot - MIT licence
*/L.KML=L.FeatureGroup.extend({initialize:function(e){this._kml=e,this._layers={},e&&this.addKML(e)},addKML:function(e){var t=L.KML.parseKML(e);if(!(!t||!t.length)){for(var r=0;r<t.length;r++)this.fire("addlayer",{layer:t[r]}),this.addLayer(t[r]);this.latLngs=L.KML.getLatLngs(e),this.fire("loaded")}},latLngs:[]});L.Util.extend(L.KML,{parseKML:function(e){var t=this.parseStyles(e);this.parseStyleMap(e,t);for(var r=e.getElementsByTagName("Folder"),a=[],n,o=0;o<r.length;o++)!this._check_folder(r[o])||(n=this.parseFolder(r[o],t),n&&a.push(n));r=e.getElementsByTagName("Placemark");for(var s=0;s<r.length;s++)!this._check_folder(r[s])||(n=this.parsePlacemark(r[s],e,t),n&&a.push(n));r=e.getElementsByTagName("GroundOverlay");for(var i=0;i<r.length;i++)n=this.parseGroundOverlay(r[i]),n&&a.push(n);return a},_check_folder:function(e,t){for(e=e.parentNode;e&&e.tagName!=="Folder";)e=e.parentNode;return!e||e===t},parseStyles:function(e){for(var t={},r=e.getElementsByTagName("Style"),a=0,n=r.length;a<n;a++){var o=this.parseStyle(r[a]);if(o){var s="#"+o.id;t[s]=o}}return t},parseStyle:function(e){var t={},r={},a={},n,o,s={color:!0,width:!0,Icon:!0,href:!0,hotSpot:!0};function i(l){for(var c={},g=0;g<l.childNodes.length;g++){var d=l.childNodes[g],f=d.tagName;if(!!s[f])if(f==="hotSpot")for(var h=0;h<d.attributes.length;h++)c[d.attributes[h].name]=d.attributes[h].nodeValue;else{var u=d.childNodes[0].nodeValue;f==="color"?(c.opacity=parseInt(u.substring(0,2),16)/255,c.color="#"+u.substring(6,8)+u.substring(4,6)+u.substring(2,4)):f==="width"?c.weight=u:f==="Icon"?(a=i(d),a.href&&(c.href=a.href)):f==="href"&&(c.href=u)}}return c}return n=e.getElementsByTagName("LineStyle"),n&&n[0]&&(t=i(n[0])),n=e.getElementsByTagName("PolyStyle"),n&&n[0]&&(r=i(n[0])),r.color&&(t.fillColor=r.color),r.opacity&&(t.fillOpacity=r.opacity),n=e.getElementsByTagName("IconStyle"),n&&n[0]&&(a=i(n[0])),a.href&&(t.icon=new L.KMLIcon({iconUrl:a.href,shadowUrl:null,anchorRef:{x:a.x,y:a.y},anchorType:{x:a.xunits,y:a.yunits}})),o=e.getAttribute("id"),o&&t&&(t.id=o),t},parseStyleMap:function(e,t){for(var r=e.getElementsByTagName("StyleMap"),a=0;a<r.length;a++){var n=r[a],o,s,i;o=n.getElementsByTagName("key"),o&&o[0]&&(s=o[0].textContent),o=n.getElementsByTagName("styleUrl"),o&&o[0]&&(i=o[0].textContent),s==="normal"&&(t["#"+n.getAttribute("id")]=t[i])}},parseFolder:function(e,t){var r,a=[],n;r=e.getElementsByTagName("Folder");for(var o=0;o<r.length;o++)!this._check_folder(r[o],e)||(n=this.parseFolder(r[o],t),n&&a.push(n));r=e.getElementsByTagName("Placemark");for(var s=0;s<r.length;s++)!this._check_folder(r[s],e)||(n=this.parsePlacemark(r[s],e,t),n&&a.push(n));r=e.getElementsByTagName("GroundOverlay");for(var i=0;i<r.length;i++)!this._check_folder(r[i],e)||(n=this.parseGroundOverlay(r[i]),n&&a.push(n));if(!!a.length)return a.length===1?a[0]:new L.FeatureGroup(a)},parsePlacemark:function(e,t,r,a){var n,o,s,i,l,c,g=a||{};for(l=e.getElementsByTagName("styleUrl"),o=0;o<l.length;o++){var d=l[o].childNodes[0].nodeValue;for(var f in r[d])g[f]=r[d][f]}if(c=e.getElementsByTagName("Style")[0],c){var h=this.parseStyle(e);if(h)for(i in h)g[i]=h[i]}var u=["MultiGeometry","MultiTrack","gx:MultiTrack"];for(n in u)for(l=e.getElementsByTagName(u[n]),o=0;o<l.length;o++)return this.parsePlacemark(l[o],t,r,g);var p=[],N=["LineString","Polygon","Point","Track","gx:Track"];for(s in N){var T=N[s];for(l=e.getElementsByTagName(T),o=0;o<l.length;o++){var B=this["parse"+T.replace(/gx:/,"")](l[o],t,g);B&&p.push(B)}}if(!!p.length){var m=p[0];p.length>1&&(m=new L.FeatureGroup(p));var v,_="";for(l=e.getElementsByTagName("name"),l.length&&l[0].childNodes.length&&(v=l[0].childNodes[0].nodeValue),l=e.getElementsByTagName("description"),o=0;o<l.length;o++)for(s=0;s<l[o].childNodes.length;s++)_=_+l[o].childNodes[s].nodeValue;return v&&m.on("add",function(){m.bindPopup("<h2>"+v+"</h2>"+_,{className:"kml-popup"})}),m}},parseCoords:function(e){var t=e.getElementsByTagName("coordinates");return this._read_coords(t[0])},parseLineString:function(e,t,r){var a=this.parseCoords(e);if(!!a.length)return new L.Polyline(a,r)},parseTrack:function(e,t,r){var a=t.getElementsByTagName("gx:coord");a.length===0&&(a=t.getElementsByTagName("coord"));for(var n=[],o=0;o<a.length;o++)n=n.concat(this._read_gxcoords(a[o]));if(!!n.length)return new L.Polyline(n,r)},parsePoint:function(e,t,r){var a=e.getElementsByTagName("coordinates");if(!!a.length){var n=a[0].childNodes[0].nodeValue.split(",");return new L.KMLMarker(new L.LatLng(n[1],n[0]),r)}},parsePolygon:function(e,t,r){var a,n=[],o=[],s,i;for(a=e.getElementsByTagName("outerBoundaryIs"),s=0;s<a.length;s++)i=this.parseCoords(a[s]),i&&n.push(i);for(a=e.getElementsByTagName("innerBoundaryIs"),s=0;s<a.length;s++)i=this.parseCoords(a[s]),i&&o.push(i);if(!!n.length)return r.fillColor&&(r.fill=!0),n.length===1?new L.Polygon(n.concat(o),r):new L.MultiPolygon(n,r)},getLatLngs:function(e){for(var t=e.getElementsByTagName("coordinates"),r=[],a=0;a<t.length;a++)r=r.concat(this._read_coords(t[a]));return r},_read_coords:function(e){var t="",r=[],a;for(a=0;a<e.childNodes.length;a++)t=t+e.childNodes[a].nodeValue;for(t=t.split(/[\s\n]+/),a=0;a<t.length;a++){var n=t[a].split(",");n.length<2||r.push(new L.LatLng(n[1],n[0]))}return r},_read_gxcoords:function(e){var t="",r=[];return t=e.firstChild.nodeValue.split(" "),r.push(new L.LatLng(t[1],t[0])),r},parseGroundOverlay:function(e){var t=e.getElementsByTagName("LatLonBox")[0],r=new L.LatLngBounds([t.getElementsByTagName("south")[0].childNodes[0].nodeValue,t.getElementsByTagName("west")[0].childNodes[0].nodeValue],[t.getElementsByTagName("north")[0].childNodes[0].nodeValue,t.getElementsByTagName("east")[0].childNodes[0].nodeValue]),a={Icon:!0,href:!0,color:!0};function n(i){for(var l={},c={},g=0;g<i.childNodes.length;g++){var d=i.childNodes[g],f=d.tagName;if(!!a[f]){var h=d.childNodes[0].nodeValue;f==="Icon"?(c=n(d),c.href&&(l.href=c.href)):f==="href"?l.href=h:f==="color"&&(l.opacity=parseInt(h.substring(0,2),16)/255,l.color="#"+h.substring(6,8)+h.substring(4,6)+h.substring(2,4))}}return l}var o={};if(o=n(e),t.getElementsByTagName("rotation")[0]!==void 0){var s=t.getElementsByTagName("rotation")[0].childNodes[0].nodeValue;o.rotation=parseFloat(s)}return new L.RotatedImageOverlay(o.href,r,{opacity:o.opacity,angle:o.rotation})}});L.KMLIcon=L.Icon.extend({options:{iconSize:[32,32],iconAnchor:[16,16]},_setIconStyles:function(e,t){L.Icon.prototype._setIconStyles.apply(this,[e,t]),e.complete?this.applyCustomStyles(e):e.onload=this.applyCustomStyles.bind(this,e)},applyCustomStyles:function(e){var t=this.options;this.options.popupAnchor=[0,-.83*e.height],t.anchorType.x==="fraction"&&(e.style.marginLeft=-t.anchorRef.x*e.width+"px"),t.anchorType.y==="fraction"&&(e.style.marginTop=-(1-t.anchorRef.y)*e.height+1+"px"),t.anchorType.x==="pixels"&&(e.style.marginLeft=-t.anchorRef.x+"px"),t.anchorType.y==="pixels"&&(e.style.marginTop=t.anchorRef.y-e.height+1+"px")}});L.KMLMarker=L.Marker.extend({options:{icon:new L.KMLIcon.Default}});L.RotatedImageOverlay=L.ImageOverlay.extend({options:{angle:0},_reset:function(){L.ImageOverlay.prototype._reset.call(this),this._rotate()},_animateZoom:function(e){L.ImageOverlay.prototype._animateZoom.call(this,e),this._rotate()},_rotate:function(){if(L.DomUtil.TRANSFORM)this._image.style[L.DomUtil.TRANSFORM]+=" rotate("+this.options.angle+"deg)";else if(L.Browser.ie){var e=this.options.angle*(Math.PI/180),t=Math.cos(e),r=Math.sin(e);this._image.style.filter+=" progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+t+", M12="+-r+", M21="+r+", M22="+t+")"}},getBounds:function(){return this._bounds}});const x={id:"leaf_map"},I={__name:"kmlFile",setup(e){const t=async()=>await E.get("./data/kml/countries.kml");return b(()=>{var r=y.map("leaf_map",{crs:y.CRS.EPSG3857,center:[23.1317,113.2748],zoom:5,zoomControl:!1,attributionControl:!1});y.tileLayer("http://t0.tianditu.gov.cn/DataServer?T=img_w&x={x}&y={y}&l={z}&tk=f6d75f77a5cb66b0fcfaec5cbe58a907",{noWrap:!0}).addTo(r),y.tileLayer("http://t0.tianditu.gov.cn/DataServer?T=cia_w&x={x}&y={y}&l={z}&tk=f6d75f77a5cb66b0fcfaec5cbe58a907",{noWrap:!0}).addTo(r),t().then(a=>{const o=new DOMParser().parseFromString(a,"text/xml"),s=new y.KML(o,{async:!0});r.addLayer(s)})}),(r,a)=>(S(),w("div",x))}};var C=M(I,[["__scopeId","data-v-71d9d66a"]]);export{C as default};
