import{L as d}from"./leaflet-src.1665470366715.js";import{a as S}from"./index.1665470366715.js";import{l as M,a as G,o as C}from"./vue.1665470366715.js";/*! leaflet-wfst 2.0.1-beta.27 2021-08-10 */(function(h,f,y){L.XmlUtil={namespaces:{xlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/",xsd:"http://www.w3.org/2001/XMLSchema",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},xmldoc:new DOMParser().parseFromString("<root />","text/xml"),setAttributes:function(e,t){for(var r in t)if(t[r]!=null&&t[r].toString){var i=t[r].toString(),n=this.namespaces[r.substring(0,r.indexOf(":"))]||null;e.setAttributeNS(n,r,i)}},evaluate:function(e,t){var r=t;r instanceof Document||(r=this.parseXml(t));var i=new XPathEvaluator,n=i.createNSResolver(r.documentElement);return i.evaluate(e,r,n,XPathResult.ANY_TYPE,null)},createElementNS:function(e,t,r){r=r||{};var i=r.uri;i||(i=this.namespaces[e.substring(0,e.indexOf(":"))]),i||(i=this.namespaces[r.prefix]);var n=i?this.xmldoc.createElementNS(i,e):this.xmldoc.createElement(e);return t&&this.setAttributes(n,t),r.value!=null&&n.appendChild(this.xmldoc.createTextNode(r.value)),n},createTextNode:function(e){return e===null||e===y?e="":e instanceof Date&&(e=e.toISOString()),this.xmldoc.createTextNode(e)},getNodeText:function(e){return e?e.innerText||e.textContent||e.text:""},serializeXmlDocumentString:function(e){var t=f.implementation.createDocument("","",null);t.appendChild(e);var r=new XMLSerializer;return r.serializeToString(t)},serializeXmlToString:function(e){var t=new XMLSerializer;return t.serializeToString(e)},parseXml:function(e){if(typeof h.DOMParser!="undefined")return new h.DOMParser().parseFromString(e,"text/xml");if(typeof h.ActiveXObject!="undefined"&&new h.ActiveXObject("Microsoft.XMLDOM")){var t=new h.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}else throw new Error("No XML parser found")},parseOwsExceptionReport:function(e){var t=e;t instanceof Document||(t=this.parseXml(e));var r=t.documentElement;if(!r||r.tagName!=="ows:ExceptionReport")return null;for(var i={exceptions:[],message:""},n=r.getElementsByTagNameNS(L.XmlUtil.namespaces.ows,"Exception"),a=0,o=n.length;a<o;a++){for(var s=n[a],l=s.getAttribute("exceptionCode"),c=s.getElementsByTagNameNS(L.XmlUtil.namespaces.ows,"ExceptionText"),p={code:l,text:""},u=0,m=c.length;u<m;u++){var g=c[u],v=g.innerText||g.textContent||g.text;p.text+=v,u<m-1&&(p.text+=". ")}i.message+=p.code+" - "+p.text,a<o-1&&(i.message+=" "),i.exceptions.push(p)}return i}},L.Util.request=function(e){e=L.extend({async:!0,method:"POST",data:"",params:{},headers:{},url:h.location.href,withCredentials:!1,success:function(n){console.log(n)},error:function(n){console.log("Ajax request fail"),console.log(n)},complete:function(){}},e);var t=new XMLHttpRequest;t.onreadystatechange=function(){t.readyState===4&&(t.status===200?e.success(t.responseText):e.error(t.responseText),e.complete())},t.withCredentials=e.withCredentials;var r=e.url+L.Util.getParamString(e.params,e.url);t.open(e.method,r,e.async);for(var i in e.headers)t.setRequestHeader(i,e.headers[i]);t.send(e.data)},L.Filter={},L.filter=function(e){var t=L.XmlUtil.createElementNS("ogc:Filter");return Array.isArray(e)?e.forEach(function(r){t.appendChild(r instanceof Element?r:r.toGml())}):e&&t.appendChild(e instanceof Element?e:e.toGml()),t},L.Filter.propertyName=function(e){return L.XmlUtil.createElementNS("ogc:PropertyName",{},{value:e})},L.Filter.literal=function(e){return L.XmlUtil.createElementNS("ogc:Literal",{},{value:e})},L.Filter.element=function(e){return e instanceof Element?e:e.toGml()},L.Filter.propertyElement=function(e){return e instanceof Element?e:e&&typeof e.toGml=="function"?e.toGml():L.Filter.propertyName(e)},L.Filter.literalElement=function(e){return e instanceof Element?e:e&&typeof e.toGml=="function"?e.toGml():L.Filter.literal(e)},L.Filter.Abstract=L.Class.extend({attributes:{},options:{},tagName:null,buildFilterContent:function(){throw"Build filter content is abstract and should be implemented"},toGml:function(){var e=L.XmlUtil.createElementNS(this.tagName,this.attributes,this.options);return this.buildFilterContent(e),e}}),L.Filter.BinarySpatial=L.Filter.Abstract.extend({initialize:function(e,t,r){this.propertyName=e,this.value=t,this.crs=r},buildFilterContent:function(e){return e.appendChild(L.Filter.propertyName(this.propertyName)),typeof this.value=="string"?e.appendChild(L.Filter.propertyName(this.value)):e.appendChild(this.value.toGml(this.crs)),e}}),L.Filter.Equals=L.Filter.BinarySpatial.extend({tagName:"ogc:Equals"}),L.Filter.equals=function(e){return new L.Filter.Equals(e)},L.Filter.Disjoint=L.Filter.BinarySpatial.extend({tagName:"ogc:Disjoint"}),L.Filter.disjoint=function(e){return new L.Filter.Disjoint(e)},L.Filter.Touches=L.Filter.BinarySpatial.extend({tagName:"ogc:Touches"}),L.Filter.touches=function(e){return new L.Filter.Touches(e)},L.Filter.Within=L.Filter.BinarySpatial.extend({tagName:"ogc:Within"}),L.Filter.within=function(e){return new L.Filter.Within(e)},L.Filter.Overlaps=L.Filter.BinarySpatial.extend({tagName:"ogc:Overlaps"}),L.Filter.overlaps=function(e){return new L.Filter.Overlaps(e)},L.Filter.Crosses=L.Filter.BinarySpatial.extend({tagName:"ogc:Crosses"}),L.Filter.crosses=function(e){return new L.Filter.Crosses(e)},L.Filter.Intersects=L.Filter.BinarySpatial.extend({tagName:"ogc:Intersects"}),L.Filter.intersects=function(e){return new L.Filter.Intersects(e)},L.Filter.Contains=L.Filter.BinarySpatial.extend({tagName:"ogc:Contains"}),L.Filter.contains=function(e){return new L.Filter.Contains(e)},L.Filter.DistanceBuffer=L.Filter.Abstract.extend({initialize:function(e,t,r,i,n){this.propertyName=e,this.geomerty=t,this.crs=r,this.distance=i,this.units=n},buildFilterContent:function(e){e.appendChild(L.Filter.propertyName(this.propertyName)),e.appendChild(this.geomerty.toGml(this.crs)),e.appendChild(L.XmlUtil.createElementNS("ogc:Distance",{units:this.units},{value:this.distance}))}}),L.Filter.DWithin=L.Filter.DistanceBuffer.extend({tagName:"ogc:DWithin"}),L.Filter.dwithin=function(e,t,r,i,n){return new L.Filter.DWithin(e,t,r,i,n)},L.Filter.Beyond=L.Filter.DistanceBuffer.extend({tagName:"ogc:Beyond"}),L.Filter.beyond=function(e,t,r,i,n){return new L.Filter.Beyond(e,t,r,i,n)},L.Filter.BBox=L.Filter.Abstract.extend({tagName:"ogc:BBOX",geometryField:null,bbox:null,crs:null,initialize:function(e,t,r){this.bbox=t,this.geometryField=e,this.crs=r},buildFilterContent:function(e){this.geometryField&&e.appendChild(L.Filter.propertyName(this.geometryField)),e.appendChild(this.bbox.toGml(this.crs))}}),L.Filter.bbox=function(e,t,r){return new L.Filter.BBox(e,t,r)},L.Filter.GmlObjectID=L.Filter.Abstract.extend({tagName:"ogc:GmlObjectId",initialize:function(e){this.attributes={"gml:id":e}},buildFilterContent:function(){}}),L.Filter.gmlobjectid=function(e){return new L.Filter.GmlObjectID(e)},L.Filter.BinaryOperator=L.Filter.Abstract.extend({initialize:function(e,t){this.firstValue=e,this.secondValue=t},buildFilterContent:function(e){e.appendChild(L.Filter.propertyElement(this.firstValue)),e.appendChild(L.Filter.literalElement(this.secondValue))}}),L.Filter.Add=L.Filter.BinaryOperator.extend({tagName:"Add"}),L.Filter.add=function(e,t){return new L.Filter.Add(e,t)},L.Filter.Sub=L.Filter.BinaryOperator.extend({tagName:"Sub"}),L.Filter.sub=function(e,t){return new L.Filter.Sub(e,t)},L.Filter.Mul=L.Filter.BinaryOperator.extend({tagName:"Mul"}),L.Filter.mul=function(e,t){return new L.Filter.Mul(e,t)},L.Filter.Div=L.Filter.BinaryOperator.extend({tagName:"Div"}),L.Filter.div=function(e,t){return new L.Filter.Div(e,t)},L.Filter.BinaryComparison=L.Filter.BinaryOperator.extend({matchCase:!1,initialize:function(e,t,r){L.Filter.BinaryOperator.prototype.initialize.call(this,e,t),this.attributes={matchCase:!!r}}}),L.Filter.EQ=L.Filter.BinaryComparison.extend({tagName:"ogc:PropertyIsEqualTo"}),L.Filter.eq=function(e,t){return new L.Filter.EQ(e,t)},L.Filter.NotEQ=L.Filter.BinaryComparison.extend({tagName:"ogc:PropertyIsNotEqualTo"}),L.Filter.neq=function(e,t){return new L.Filter.NotEQ(e,t)},L.Filter.LT=L.Filter.BinaryComparison.extend({tagName:"ogc:PropertyIsLessThan"}),L.Filter.lt=function(e,t){return new L.Filter.LT(e,t)},L.Filter.GT=L.Filter.BinaryComparison.extend({tagName:"ogc:PropertyIsGreaterThan"}),L.Filter.gt=function(e,t){return new L.Filter.GT(e,t)},L.Filter.LEQ=L.Filter.BinaryComparison.extend({tagName:"ogc:PropertyIsLessThanOrEqualTo"}),L.Filter.leq=function(e,t){return new L.Filter.LEQ(e,t)},L.Filter.GEQ=L.Filter.BinaryComparison.extend({tagName:"ogc:PropertyIsGreaterThanOrEqualTo"}),L.Filter.geq=function(e,t){return new L.Filter.GEQ(e,t)},L.Filter.Like=L.Filter.Abstract.extend({tagName:"ogc:PropertyIsLike",wildCard:"*",singleChar:"#",escapeChar:"!",matchCase:!0,initialize:function(e,t,r){this.name=e,this.val=t;var i={wildCard:this.wildCard,singleChar:this.singleChar,escapeChar:this.escapeChar,matchCase:this.matchCase};this.attributes=L.extend(i,r||{})},buildFilterContent:function(e){var t=L.Filter.propertyName(this.name),r=L.Filter.literal(this.val);return e.appendChild(t),e.appendChild(r),e}}),L.Filter.like=function(e,t,r){return new L.Filter.Like(e,t,r)},L.Filter.IsNull=L.Filter.Abstract.extend({tagName:"ogc:PropertyIsNull",initialize:function(e){this.propertyName=e},buildFilterContent:function(e){e.appendChild(L.Filter.propertyName(this.propertyName))}}),L.Filter.isnull=function(e){return new L.Filter.IsNull(e)},L.Filter.IsBetween=L.Filter.Abstract.extend({tagName:"ogc:PropertyIsBetween",initialize:function(e,t,r){this.property=e,this.lowerBoundary=t,this.upperBoundary=r},buildFilterContent:function(e){e.appendChild(L.Filter.propertyElement(this.property));var t=L.XmlUtil.createElementNS("ogc:LowerBoundary");t.appendChild(L.Filter.literalElement(this.lowerBoundary)),e.appendChild(t);var r=L.XmlUtil.createElementNS("ogc:UpperBoundary");r.appendChild(L.Filter.literalElement(this.upperBoundary)),e.appendChild(r)}}),L.Filter.isbetween=function(e,t,r){return new L.Filter.IsBetween(e,t,r)},L.Filter.BinaryLogic=L.Filter.Abstract.extend({filters:null,initialize:function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.filters=e},buildFilterContent:function(e){this.filters.forEach(function(t){e.appendChild(L.Filter.element(t))})}}),L.Filter.And=L.Filter.BinaryLogic.extend({tagName:"And"}),L.Filter.and=function(){return new(Function.prototype.bind.apply(L.Filter.And,arguments))},L.Filter.Or=L.Filter.BinaryLogic.extend({tagName:"Or"}),L.Filter.or=function(){return new(Function.prototype.bind.apply(L.Filter.Or,arguments))},L.Filter.Not=L.Filter.Abstract.extend({tagName:"Not",initialize:function(e){this.filter=e},buildFilterContent:function(e){e.appendChild(L.Filter.element(this.filter))}}),L.Filter.not=function(e){return new L.Filter.Not(e)},L.Filter.Function=L.Filter.Abstract.extend({tagName:"Function",initialize:function(){var e=arguments[0];this.attributes={name:e};for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);this.expressions=t},buildFilterContent:function(e){var t=this.expressions[0];e.appendChild(L.Filter.propertyElement(t));for(var r=1;r<this.expressions.length;r++){var i=this.expressions[r];e.appendChild(L.Filter.literalElement(i))}}}),L.Filter.function=function(){return new(Function.prototype.bind.apply(L.Filter.Function,arguments))},L.Format={},L.Format.Scheme=L.Class.extend({options:{geometryField:"Shape"},initialize:function(e){L.setOptions(this,e)},parse:function(e){for(var t=new L.GML.FeatureType({geometryField:this.options.geometryField}),r=e.getElementsByTagNameNS(L.XmlUtil.namespaces.xsd,"complexType")[0],i=r.getElementsByTagNameNS(L.XmlUtil.namespaces.xsd,"sequence")[0],n=0;n<i.children.length;n++){var a=i.children[n],o=a.attributes.name;if(!!o){var s=a.attributes.name.value,l=a.attributes.type;if(!l){var c=a.getElementsByTagNameNS(L.XmlUtil.namespaces.xsd,"restriction");l=c.attributes.base}if(!!l){var p=l.value.split(":").pop();if(s===this.options.geometryField){t.geometryFields[s]=p;continue}t.appendField(s,p)}}}return t}}),L.Format.Base=L.Class.extend({defaultOptions:{crs:L.CRS.EPSG3857,coordsToLatLng:function(e){return new L.LatLng(e[1],e[0],e[2])},latLngToCoords:function(e){var t=[e.lng,e.lat];return e.alt!==y&&t.push(e.alt),t},geometryField:"Shape"},initialize:function(e){if(L.setOptions(this,L.extend({},this.defaultOptions,e)),e.crs){var t=e.crs;this.options.coordsToLatLng=function(r){var i=L.point(r[0],r[1]),n=t.projection.unproject(i);return r[2]&&(n.alt=r[2]),n},this.options.latLngToCoords=function(r){var i=L.latLng(r);return t.projection.project(i)}}},setFeatureDescription:function(e){this.namespaceUri=e.attributes.targetNamespace.value;var t=new L.Format.Scheme({geometryField:this.options.geometryField});this.featureType=t.parse(e)},responseToLayers:function(){throw"responseToLayers is abstract and should be implemented"}}),L.Format.GeoJSON=L.Format.Base.extend({outputFormat:"application/json",responseToLayers:function(e){for(var t=[],r=JSON.parse(e),i=0;i<r.features.length;i++){var n=this.processFeature(r.features[i]);n&&t.push(n)}return t},processFeature:function(e){var t=this.generateLayer(e);return t?(t.feature=e,t):null},generateLayer:function(e){var t=L.GeoJSON.geometryToLayer(e,this.options||null);return t||(console.log("Geometry field doesn' exist inside received feature: '"+e+"', so feature will be skipped and won't be converted into leaflet layer"),null)}}),L.GML=L.GML||{},L.GML.ParserContainerMixin={parsers:{},initializeParserContainer:function(){this.parsers={}},appendParser:function(e){this.parsers[e.elementTag]=e},parseElement:function(e,t){var r=this.parsers[e.tagName];if(!r)throw"unknown child element "+e.tagName;return r.parse(e,t)}},L.GML.Element=L.Class.extend({elementTag:"",parse:function(){throw"not implemented parse function in parser for "+this.elementTag}}),L.GML.Geometry=L.GML.Element.extend({elementOptions:function(e,t){var r=L.extend({},t),i=e.getAttribute("srsDimension");return i&&(r.dimension=parseInt(i)),r}}),L.GML.Coordinates=L.GML.Element.extend({defaultSeparator:{ds:".",cs:",",ts:" "},elementTag:"gml:coordinates",parse:function(e){var t=this.defaultSeparator.ds;e.attributes.decimal&&(t=e.attributes.decimal.value);var r=this.defaultSeparator.cs;e.attributes.cs&&(r=e.attributes.cs.value);var i=this.defaultSeparator.ts;e.attributes.ts&&(i=e.attributes.ts.value);for(var n=[],a=e.textContent.split(i),o=function(l){return t!=="."&&(l=l.replace(t,".")),parseFloat(l)},s=0;s<a.length;s++)n.push(a[s].split(r).map(o));return n.length===1?n[0]:n}}),L.GML.Pos=L.GML.Element.extend({elementTag:"gml:pos",parse:function(e){return e.textContent.split(" ").map(function(t){return parseFloat(t)})}}),L.GML.PosList=L.GML.Element.extend({statics:{DIM:2},elementTag:"gml:posList",parse:function(e,t){var r=[];t=t||{};for(var i=t.dimension||L.GML.PosList.DIM,n=e.textContent.split(" "),a=0;a<n.length;a+=i){for(var o=[],s=a;s<a+i;s++)o.push(parseFloat(n[s]));r.push(o)}return r}}),L.GML.PointNode=L.GML.Geometry.extend({includes:L.GML.ParserContainerMixin,elementTag:"gml:Point",initialize:function(){this.initializeParserContainer(),this.appendParser(new L.GML.Pos),this.appendParser(new L.GML.Coordinates)},parse:function(e,t){return t=this.elementOptions(e,t),this.parseElement(e.firstElementChild,t)}}),L.GML.PointSequence=L.GML.Geometry.extend({includes:L.GML.ParserContainerMixin,initialize:function(){this.initializeParserContainer(),this.appendParser(new L.GML.Pos),this.appendParser(new L.GML.PosList),this.appendParser(new L.GML.Coordinates),this.appendParser(new L.GML.PointNode)},parse:function(e,t){t=this.elementOptions(e,t);var r=e.firstElementChild,i=[],n=r.tagName;if(n==="gml:pos"||n==="gml:Point")for(var a=this.parsers[n],o=e.getElementsByTagNameNS(L.XmlUtil.namespaces.gml,n.split(":").pop()),s=0;s<o.length;s++)i.push(a.parse(o[s],t));else i=this.parseElement(r,t);return i}}),L.GML.LinearRing=L.GML.PointSequence.extend({elementTag:"gml:LinearRing",parse:function(e,t){var r=L.GML.PointSequence.prototype.parse.call(this,e,t);return r.pop(),r}}),L.GML.LineStringNode=L.GML.PointSequence.extend({elementTag:"gml:LineString"}),L.GML.PolygonNode=L.GML.Geometry.extend({elementTag:"gml:Polygon",initialize:function(){this.linearRingParser=new L.GML.LinearRing},parse:function(e,t){t=this.elementOptions(e,t);for(var r=[],i=0;i<e.children.length;i++){var n=e.children[i];r.push(this.linearRingParser.parse(n.firstElementChild,t))}return r}}),L.GML.CoordsToLatLngMixin={transform:function(e,t){if(Array.isArray(e[0])){for(var r=[],i=0;i<e.length;i++)r.push(this.transform(e[i],t));return r}return t.coordsToLatLng(e)}},L.GML.Point=L.GML.PointNode.extend({includes:L.GML.CoordsToLatLngMixin,parse:function(e,t){var r=L.GML.PointNode.prototype.parse.call(this,e,t),i=new L.Marker;return i.setLatLng(this.transform(r,t)),i}}),L.GML.LineString=L.GML.LineStringNode.extend({includes:L.GML.CoordsToLatLngMixin,parse:function(e,t){var r=new L.Polyline([]),i=L.GML.LineStringNode.prototype.parse.call(this,e);return r.setLatLngs(this.transform(i,t)),r}}),L.GML.Polygon=L.GML.PolygonNode.extend({includes:L.GML.CoordsToLatLngMixin,parse:function(e,t){var r=new L.Polygon([]),i=L.GML.PolygonNode.prototype.parse.call(this,e,t);return r.setLatLngs(this.transform(i,t)),r}}),L.GML.MultiGeometry=L.GML.Geometry.extend({includes:[L.GML.ParserContainerMixin,L.GML.CoordsToLatLngMixin],initialize:function(){this.initializeParserContainer()},parse:function(e,t){t=this.elementOptions(e,t);for(var r=[],i=0;i<e.children.length;i++)for(var n=e.children[i],a=0;a<n.children.length;a++){var o=n.children[a];r.push(this.parseElement(o,t))}return this.transform(r,t)}}),L.GML.AbstractMultiPolyline=L.GML.MultiGeometry.extend({initialize:function(){L.GML.MultiGeometry.prototype.initialize.call(this),this.appendParser(new L.GML.LineStringNode)},parse:function(e,t){var r=L.GML.MultiGeometry.prototype.parse.call(this,e,t),i=new L.Polyline([]);return i.setLatLngs(r),i}}),L.GML.AbstractMultiPolygon=L.GML.MultiGeometry.extend({initialize:function(){L.GML.MultiGeometry.prototype.initialize.call(this),this.appendParser(new L.GML.PolygonNode)},parse:function(e,t){var r=L.GML.MultiGeometry.prototype.parse.call(this,e,t),i=new L.Polygon([]);return i.setLatLngs(r),i}}),L.GML.MultiLineString=L.GML.AbstractMultiPolyline.extend({elementTag:"gml:MultiLineString"}),L.GML.MultiCurve=L.GML.AbstractMultiPolyline.extend({elementTag:"gml:MultiCurve"}),L.GML.MultiPolygon=L.GML.AbstractMultiPolygon.extend({elementTag:"gml:MultiPolygon"}),L.GML.MultiSurface=L.GML.AbstractMultiPolygon.extend({elementTag:"gml:MultiSurface"}),L.GML.MultiPoint=L.GML.MultiGeometry.extend({elementTag:"gml:MultiPoint",initialize:function(){L.GML.MultiGeometry.prototype.initialize.call(this),this.appendParser(new L.GML.PointNode)},parse:function(e,t){for(var r=L.GML.MultiGeometry.prototype.parse.call(this,e,t),i=new L.FeatureGroup,n=0;n<r.length;n++){var a=new L.Marker;a.setLatLng(r[n]),i.addLayer(a)}return i}}),L.GML.FeatureType=L.Class.extend({options:{geometryField:"Shape"},primitives:[{types:["byte","short","int","integer","long","float","double","decimal"],parse:function(e){return e===0?0:(e=String.prototype.trim.call(e||""),e===""?null:Number(e))},validate:function(e){return!isNaN(e)},type:"number"},{types:["string"],parse:function(e){return e},validate:function(e){return!0},type:"string"},{types:["boolean"],parse:function(e){return e=String.prototype.trim.call(e||"").toLowerCase(),e!=="false"},validate:function(e){return!0},type:"boolean"},{types:["date","time","datetime"],parse:function(e){return e=String.prototype.trim.call(e||""),e===""?null:new Date(e)},validate:function(e){return!isNaN(e)},type:"date"}],initialize:function(e){L.setOptions(this,e),this.fields={},this.fieldValidators={},this.fieldTypes={},this.geometryFields={}},appendField:function(e,t){var r=this;t=String.prototype.toLowerCase.call(t||""),this.primitives.forEach(function(i){i.types.indexOf(t)!==-1&&(r.fields[e]=i.parse,r.fieldValidators[e]=i.validate,r.fieldTypes[e]=i.type)})},parse:function(e){for(var t={},r=0;r<e.children.length;r++){var i=e.children[r],n=i.tagName.split(":").pop();if(n!==this.options.geometryField){var a=this.fields[n];a||(this.appendField(n,"string"),a=this.fields[n]),t[n]=a(i.textContent)}}return{type:"Feature",properties:t,id:e.attributes["gml:id"].value}}}),L.Format.GML=L.Format.Base.extend({includes:L.GML.ParserContainerMixin,outputFormat:"text/xml; subtype=gml/3.1.1",initialize:function(e){L.Format.Base.prototype.initialize.call(this,e),this.initializeParserContainer(),this.appendParser(new L.GML.Point),this.appendParser(new L.GML.LineString),this.appendParser(new L.GML.Polygon),this.appendParser(new L.GML.MultiLineString),this.appendParser(new L.GML.MultiPolygon),this.appendParser(new L.GML.MultiCurve),this.appendParser(new L.GML.MultiSurface),this.appendParser(new L.GML.MultiPoint)},responseToLayers:function(e){for(var t=[],r=L.XmlUtil.parseXml(e),i=r.documentElement,n=i.getElementsByTagNameNS(L.XmlUtil.namespaces.gml,"featureMember"),a=0;a<n.length;a++){var o=n[a].firstElementChild,s=this.processFeature(o);s&&t.push(s)}var l=i.getElementsByTagNameNS(L.XmlUtil.namespaces.gml,"featureMembers");if(l.length>0)for(var c=l[0].children,p=0;p<c.length;p++){var u=c[p],m=this.processFeature(u);m&&t.push(m)}return t},processFeature:function(e){var t=this.generateLayer(e);return t?(t.feature=this.featureType.parse(e),t):null},generateLayer:function(e){var t=e.getElementsByTagNameNS(this.namespaceUri,this.options.geometryField)[0];return t?this.parseElement(t.firstElementChild,this.options):(console.log("Geometry field '"+this.options.geometryField+"' doesn' exist inside received feature: '"+e.innerHTML+"', so feature will be skipped and won't be converted into leaflet layer"),null)}}),L.Util.project=function(e,t){if(L.Util.isArray(t)){var r=[];return t.forEach(function(i){r.push(L.Util.project(e,i))}),r}else return e.projection.project(t)},L.Util.isFlat=L.LineUtil.isFlat||L.LineUtil._flat||L.Polyline._flat,L.GmlUtil={posNode:function(e){return L.XmlUtil.createElementNS("gml:pos",{srsDimension:2},{value:e.x+" "+e.y})},posListNode:function(e,t){var r=[];if(e.forEach(function(a){r.push(a.x+" "+a.y)}),t&&e.length>0){var i=e[0];r.push(i.x+" "+i.y)}var n=r.join(" ");return L.XmlUtil.createElementNS("gml:posList",{},{value:n})}},L.CircleMarker.include({toGml:function(e){var t=L.XmlUtil.createElementNS("gml:Point",{srsName:e.code});return t.appendChild(L.GmlUtil.posNode(L.Util.project(e,this.getLatLng()))),t}}),L.LatLngBounds.prototype.toGml=function(e){var t=e.project(this.getSouthWest()),r=e.project(this.getNorthEast()),i=L.XmlUtil.createElementNS("gml:Envelope",{srsName:e.code});return i.appendChild(L.XmlUtil.createElementNS("gml:lowerCorner",{},{value:t.x+" "+t.y})),i.appendChild(L.XmlUtil.createElementNS("gml:upperCorner",{},{value:r.x+" "+r.y})),i},L.Marker.include({toGml:function(e){var t=L.XmlUtil.createElementNS("gml:Point",{srsName:e.code});return t.appendChild(L.GmlUtil.posNode(L.Util.project(e,this.getLatLng()))),t}}),L.Polygon.include({toGml:function(e,t){for(var r=this.getLatLngs(),i=[],n=0;n<r.length;n++){var a=r[n],o=L.Util.isFlat(a),s=L.XmlUtil.createElementNS("gml:Polygon",{srsName:e.code,srsDimension:2});if(s.appendChild(L.XmlUtil.createElementNS("gml:exterior")).appendChild(L.XmlUtil.createElementNS("gml:LinearRing",{srsDimension:2})).appendChild(L.GmlUtil.posListNode(L.Util.project(e,o?a:a[0]),!0)),!o)for(var l=1;l<a.length;l++)s.appendChild(L.XmlUtil.createElementNS("gml:interior")).appendChild(L.XmlUtil.createElementNS("gml:LinearRing",{srsDimension:2})).appendChild(L.GmlUtil.posListNode(L.Util.project(e,a[l]),!0));i.push(s)}if(i.length===1&&!t)return i[0];for(var c=L.XmlUtil.createElementNS("gml:MultiSurface",{srsName:e.code,srsDimension:2}),p=c.appendChild(L.XmlUtil.createElementNS("gml:surfaceMembers")),u=0;u<i.length;u++)p.appendChild(i[u]);return c}}),L.Polyline.include({_lineStringNode:function(e,t){var r=L.XmlUtil.createElementNS("gml:LineString",{srsName:e.code,srsDimension:2});return r.appendChild(L.GmlUtil.posListNode(L.Util.project(e,t),!1)),r},toGml:function(e,t){var r=this.getLatLngs(),i=[];if(L.Util.isFlat(r))i.push(this._lineStringNode(e,r));else for(var n=0;n<r.length;n++)i.push(this._lineStringNode(e,r[n]));if(i.length===1&&!t)return i[0];for(var a=L.XmlUtil.createElementNS("gml:MultiCurve",{srsName:e.code,srsDimension:2}),o=a.appendChild(L.XmlUtil.createElementNS("gml:curveMembers")),s=0;s<i.length;s++)o.appendChild(i[s]);return a}});var F={setProperties:function(e){for(var t in e)e.hasOwnProperty(t)&&(this.feature.properties[t]=e[t])},getProperty:function(e){return this.feature.properties[e]},deleteProperties:function(e){for(var t=0;t<e.length;t++)this.feature.properties.hasOwnProperty(e[t])&&delete this.feature.properties[e[t]]}};L.Marker.include(F),L.Path.include(F),L.WFS=L.FeatureGroup.extend({_capabilities:null,_boundingBox:null,options:{crs:L.CRS.EPSG3857,showExisting:!0,geometryField:"Shape",url:"",version:"1.1.0",typeNS:"",typeName:"",typeNSName:"",maxFeatures:null,vendorOptions:null,filter:null,opacity:1,fillOpacity:1,style:{color:"black",weight:1,opacity:1,fillOpacity:1},namespaceUri:"",withCredentials:!1},state:{},initialize:function(e,t){L.setOptions(this,e),this.state={exist:"exist"},this._layers={},this.readFormat=t||new L.Format.GML({crs:this.options.crs,geometryField:this.options.geometryField}),this.options.typeNSName=this.namespaceName(this.options.typeName),this.options.srsName=this.options.crs.code,this._updateOpacity();var r=this;this.describeFeatureType(function(){r.options.showExisting?r.loadFeatures(r.options.filter):r.fire("load",{})},function(i){r.fire("error",{error:new Error(i)})})},namespaceName:function(e){return this.options.typeNS+":"+e},describeFeatureType:function(e,t){var r=L.XmlUtil.createElementNS("wfs:DescribeFeatureType",{service:"WFS",version:this.options.version});r.appendChild(L.XmlUtil.createElementNS("TypeName",{},{value:this.options.typeNSName}));var i=this;L.Util.request({url:this.options.url,data:L.XmlUtil.serializeXmlDocumentString(r),headers:this.options.headers||{},withCredentials:this.options.withCredentials,success:function(n){var a=L.XmlUtil.parseOwsExceptionReport(n);if(a){typeof t=="function"&&t(a.message);return}var o=L.XmlUtil.parseXml(n),s=o.documentElement;i.readFormat.setFeatureDescription(s),i.options.namespaceUri=s.attributes.targetNamespace.value,typeof e=="function"&&e()},error:function(n){typeof t=="function"&&t(n)}})},getFeature:function(e){var t={service:"WFS",version:this.options.version,maxFeatures:this.options.maxFeatures,outputFormat:this.readFormat.outputFormat};if(this.options.vendorOptions)for(var r in this.options.vendorOptions)t[r]=this.options.vendorOptions[r];var i=L.XmlUtil.createElementNS("wfs:GetFeature",t),n=i.appendChild(L.XmlUtil.createElementNS("wfs:Query",{typeName:this.options.typeNSName,srsName:this.options.srsName}));return e&&n.appendChild(L.filter(e)),i},loadFeatures:function(e){var t=this;L.Util.request({url:this.options.url,data:L.XmlUtil.serializeXmlDocumentString(t.getFeature(e)),headers:this.options.headers||{},withCredentials:this.options.withCredentials,success:function(r){var i=L.XmlUtil.parseOwsExceptionReport(r);if(i)return t.fire("error",{error:new Error(i.message)}),t;var n=t.readFormat.responseToLayers(r,{coordsToLatLng:t.options.coordsToLatLng,pointToLayer:t.options.pointToLayer});return typeof t.options.style=="function"?n.forEach(function(a){a.state=t.state.exist,a.setStyle&&a.setStyle(t.options.style(a)),t.addLayer(a)}):(n.forEach(function(a){a.state=t.state.exist,t.addLayer(a)}),t.setStyle(t.options.style)),t.fire("load",{responseText:r,layers:n}),t},error:function(r){return t.fire("error",{error:new Error(r)}),t}})},getCapabilities:function(e,t){var r=this._capabilities;if(r&&typeof e=="function"){e(r);return}var i=L.XmlUtil.createElementNS("wfs:GetCapabilities",{service:"WFS",version:this.options.version}),n=this;L.Util.request({url:this.options.url,data:L.XmlUtil.serializeXmlDocumentString(i),headers:this.options.headers||{},withCredentials:this.options.withCredentials,success:function(a){var o=L.XmlUtil.parseOwsExceptionReport(a);if(o){typeof t=="function"&&t(new Error(o.message));return}try{r=L.XmlUtil.parseXml(a).documentElement}catch(s){typeof t=="function"&&t(s);return}n._capabilities=r,typeof e=="function"&&e(r)},error:function(a){typeof t=="function"&&t(new Error(a))}})},getBoundingBox:function(e,t){var r=this._boundingBox;if(r&&typeof e=="function"){e(r);return}var i=this;this.getCapabilities(function(n){for(var a=n.getElementsByTagName("FeatureTypeList")[0],o=a.getElementsByTagName("FeatureType"),s=0,l=o.length;s<l;s++){var c=o[s],p=L.XmlUtil.getNodeText(c.getElementsByTagName("Name")[0]);if(p===i.options.typeNSName){var u=c.getElementsByTagNameNS(L.XmlUtil.namespaces.ows,"WGS84BoundingBox")[0],m=u.getElementsByTagNameNS(L.XmlUtil.namespaces.ows,"LowerCorner")[0],g=u.getElementsByTagNameNS(L.XmlUtil.namespaces.ows,"UpperCorner")[0],v=L.XmlUtil.getNodeText(m),N=L.XmlUtil.getNodeText(g),w=v.split(" ").reverse(),x=N.split(" ").reverse();r=L.latLngBounds([w,x]);break}}i._boundingBox=r,typeof e=="function"&&e(r)},function(n){typeof t=="function"&&t(new Error(n))})},setOpacity:function(e,t){return this.options.opacity=e,this.options.fillOpacity=t||e,this._updateOpacity(),this},_updateOpacity:function(){var e=L.extend(this.options.style||{},{opacity:this.options.opacity,fillOpacity:this.options.fillOpacity});this.setStyle(e)}}),L.wfs=function(e,t){return new L.WFS(e,t)},L.WFST=L.WFS.extend({options:{forceMulti:!1},initialize:function(e,t){L.WFS.prototype.initialize.call(this,e,t),this.state=L.extend(this.state,{insert:"insertElement",update:"updateElement",remove:"removeElement"}),this.changes={}},addLayer:function(e){if(L.FeatureGroup.prototype.addLayer.call(this,e),e.feature||(e.feature={properties:{}}),!e.state){e.state=this.state.insert;var t=this.getLayerId(e);this.changes[t]=e}return this},removeLayer:function(e){L.FeatureGroup.prototype.removeLayer.call(this,e);var t=this.getLayerId(e);if(t in this.changes){var r=this.changes[t];r.state===this.state.insert?delete this.changes[t]:r.state=this.state.remove}else e.state=this.state.remove,this.changes[t]=e},editLayer:function(e){e.state!==this.state.insert&&(e.state=this.state.update);var t=this.getLayerId(e);return this.changes[t]=e,this},save:function(){var e=L.XmlUtil.createElementNS("wfs:Transaction",{service:"WFS",version:this.options.version}),t=[];for(var r in this.changes){var i=this.changes[r],n=this[i.state](i);e.appendChild(n),i.state===this.state.insert&&t.push(i)}var a=this;return L.Util.request({url:this.options.url,data:L.XmlUtil.serializeXmlDocumentString(e),headers:this.options.headers||{},withCredentials:this.options.withCredentials,success:function(o){var s=L.XmlUtil.parseXml(o),l=L.XmlUtil.parseOwsExceptionReport(s);if(l!==null){a.fire("save:failed",l);return}for(var c=L.XmlUtil.evaluate("//wfs:InsertResults/wfs:Feature/ogc:FeatureId/@fid",s),p=[],u=c.iterateNext();u;)p.push(new L.Filter.GmlObjectID(u.value)),u=c.iterateNext();t.forEach(function(m){L.FeatureGroup.prototype.removeLayer.call(a,m)}),a.once("load",function(m){a.fire("save:success",{layers:m.layers}),a.changes={}}),a.loadFeatures(p)},error:function(o){a.fire("save:failed",o)}}),this}}),L.wfst=function(e,t){return new L.WFST(e,t)},L.WFST.include({gmlFeature:function(e){var t=L.XmlUtil.createElementNS(this.options.typeNSName,{},{uri:this.options.namespaceUri}),r=e.feature;for(var i in r.properties)t.appendChild(this.gmlProperty(i,r.properties[i]));return t.appendChild(this.gmlProperty(this.options.geometryField,e.toGml(this.options.crs,this.options.forceMulti))),t},gmlProperty:function(e,t){var r=L.XmlUtil.createElementNS(this.namespaceName(e));return t instanceof Element?r.appendChild(t):t===null||t===y||t===""?L.XmlUtil.setAttributes(r,{"xsi:nil":!0}):r.appendChild(L.XmlUtil.createTextNode(t)),r},wfsProperty:function(e,t){var r=L.XmlUtil.createElementNS("wfs:Property");r.appendChild(L.XmlUtil.createElementNS("wfs:Name",{},{value:e}));var i=L.XmlUtil.createElementNS("wfs:Value");return t instanceof Element?i.appendChild(t):i.appendChild(L.XmlUtil.createTextNode(t)),r.appendChild(i),r}}),L.WFST.include({insertElement:function(e){var t=L.XmlUtil.createElementNS("wfs:Insert");return t.appendChild(this.gmlFeature(e)),t},updateElement:function(e){var t=L.XmlUtil.createElementNS("wfs:Update",{typeName:this.options.typeNSName}),r=e.feature;for(var i in r.properties)r.properties.hasOwnProperty(i)&&t.appendChild(this.wfsProperty(i,r.properties[i]));t.appendChild(this.wfsProperty(this.namespaceName(this.options.geometryField),e.toGml(this.options.crs,this.options.forceMulti)));var n=new L.Filter.GmlObjectID(e.feature.id);return t.appendChild(L.filter(n)),t},removeElement:function(e){var t=L.XmlUtil.createElementNS("wfs:Delete",{typeName:this.options.typeNSName}),r=new L.Filter.GmlObjectID(e.feature.id);return t.appendChild(L.filter(r)),t}})})(window,document);const E={id:"leaf_map"},P={__name:"wfsMap",setup(h){return M(()=>{var f=d.map("leaf_map",{crs:d.CRS.EPSG3857,center:[-42,145],minZoom:1,maxZoom:17,zoom:5});d.tileLayer("http://t0.tianditu.gov.cn/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=f6d75f77a5cb66b0fcfaec5cbe58a907",{noWrap:!0}).addTo(f),d.tileLayer("http://t0.tianditu.gov.cn/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=f6d75f77a5cb66b0fcfaec5cbe58a907",{noWrap:!0}).addTo(f),new d.WFS({url:"/geoserver/wfs",typeNS:"topp",typeName:"tasmania_state_boundaries",crs:d.CRS.EPSG4326,geometryField:"the_geom",style:{color:"blue",weight:1}}).addTo(f),new d.WFS({url:"/geoserver/wfs",typeNS:"topp",typeName:"tasmania_cities",crs:d.CRS.EPSG4326,geometryField:"the_geom"}).addTo(f)}),(f,y)=>(C(),G("div",E))}};var X=S(P,[["__scopeId","data-v-7a330746"]]);export{X as default};
